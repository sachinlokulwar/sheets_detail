"use strict";angular.module("csvRowsApp",["ngCookies","ngRoute","ngTouch","ngCsv"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl",controllerAs:"about"}).otherwise({redirectTo:"/"})}]),angular.module("csvRowsApp").controller("MainCtrl",["$scope",function(a){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"],a.sheet={filenames:[]};var b=function(b){var c={fileDetail:{}};c.fileDetail.name=b.name;var d=new FileReader;d.onload=function(b){var d=b.target.result,e=XLSX.read(d,{type:"binary"}),f=XLS.utils.sheet_to_row_object_array(e.Sheets[e.SheetNames[0]]);c.fileDetail.rowCount=f.length,a.sheet.filenames.push(c.fileDetail),a.$apply()},d.readAsBinaryString(b)};a.uploadFiles=function(a){var c,d=a.files;for(c=0;c<d.length;c++)b(d[c])},a.clearData=function(){a.sheet.filenames=[],document.getElementById("uploadFiles").value=""},a.test=function(){console.log(a.sheet.filenames)}}]),angular.module("csvRowsApp").controller("AboutCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),angular.module("csvRowsApp").run(["$templateCache",function(a){a.put("views/about.html","<p>This is the about view.</p>"),a.put("views/main.html",'<div class="jumbotron"> <div style="margin-bottom:20px"> <div class="row"> <div class="col-md-6"> <input id="uploadFiles" type="file" onchange="angular.element(this).scope().uploadFiles(this)" multiple> </div> <div class="col-md-6"> <button class="btn btn-info pull-right" ng-csv="sheet.filenames" csv-header="[\'Sheet Name\', \'Row Count\']" filename="sheet_details.csv">Export</button> <button class="btn btn-danger pull-right" style="margin-right:20px" ng-click="clearData()">Clear</button> </div> </div> </div> <table class="table table-sm header-fixed table-bordered"> <thead> <tr> <th class="col-md-6">Sheet Name </th> <th class="col-md-6">Row Count</th> </tr> </thead> <tbody> <tr ng-repeat="file in sheet.filenames track by $index"> <td class="col-md-6">{{file.name}}</td> <td class="col-md-2">{{file.rowCount}}</td> </tr> </tbody> </table> </div>')}]);